namespace CSharpDemo
{
    using CSharpDemo.FileOperation;
    using CSharpDemo.IDEAs;
    using CSharpDemo.InvalidCastExceptionDemo;
    using Newtonsoft.Json;
    using Newtonsoft.Json.Linq;
    using System;
    using System.Collections.Generic;
    using System.Diagnostics;
    using System.IO;
    using System.Linq;
    using System.Text;

    class Program
    {
        static void Main(string[] args)
        {
            //AzureCosmosDBOperation.MainMethod();
            //AzureServiceBus.MainMethod();

            //QueryIncidents.MainMethod();
            //FireIncident.MainMethod();

            //DataCopJsonFileOperation.MainMethod();
            //DataBuildJsonFileOperation.MainMethod();
            //AzureActiveDirectoryToken.MainMethod();
            //AzureKeyVaultDemo.MainMethod();

            string a = "Compiling script...\r\n============================================================\r\nCompiling script \"./TheScript_e7d36522-f12c-4889-ba77-37ee592a0761.script\"\r\n\r\nSettings:\r\n\tCompileForSingleBox: False\r\n9/5/2019 7:02:31 PM:  Client Version: 10.2.2.0\r\n9/5/2019 7:02:31 PM:  Target: Cluster\r\n9/5/2019 7:02:31 PM:  Stat: FetchReal\r\n9/5/2019 7:02:31 PM:  SkipPath: False\r\n9/5/2019 7:02:31 PM:  Starting FrontEndRun...\r\n9/5/2019 7:02:32 PM:  SyntaxVerifier => 0.1387 s\r\n9/5/2019 7:02:32 PM:  DdlResolver => 0.1413 s\r\nDownload started at : 9/5/2019 7:02:34 PM for D:\\IntelligentDataManagement\\Prod\\CosmosWorker_2019_9_4\\ScopeWorkingDir\\TheScript_e7d36522-f12c-4889-ba77-37ee592a0761_7BD75D30E767E37E\\IDEAsTenantProfile.view\r\n.\r\nDownload Ended at : 9/5/2019 7:02:35 PM for D:\\IntelligentDataManagement\\Prod\\CosmosWorker_2019_9_4\\ScopeWorkingDir\\TheScript_e7d36522-f12c-4889-ba77-37ee592a0761_7BD75D30E767E37E\\IDEAsTenantProfile.view\r\n9/5/2019 7:02:36 PM:  SyntaxVerifier => 0.0792 s\r\n9/5/2019 7:02:40 PM:  SyntaxVerifier => 0.1082 s\r\n9/5/2019 7:02:40 PM:  DdlResolver => 0.0095 s\r\nDownload started at : 9/5/2019 7:02:43 PM for D:\\IntelligentDataManagement\\Prod\\CosmosWorker_2019_9_4\\ScopeWorkingDir\\TheScript_e7d36522-f12c-4889-ba77-37ee592a0761_7BD75D30E767E37E\\IDEAsTenantTPIDMapping.view\r\n.\r\nDownload Ended at : 9/5/2019 7:02:44 PM for D:\\IntelligentDataManagement\\Prod\\CosmosWorker_2019_9_4\\ScopeWorkingDir\\TheScript_e7d36522-f12c-4889-ba77-37ee592a0761_7BD75D30E767E37E\\IDEAsTenantTPIDMapping.view\r\n9/5/2019 7:02:44 PM:  SyntaxVerifier => 0.0038 s\r\n9/5/2019 7:02:47 PM:  SyntaxVerifier => 0.0004 s\r\n9/5/2019 7:02:47 PM:  DdlResolver => 0.0009 s\r\n9/5/2019 7:02:47 PM:  ViewResolverPass => 0.0000 s\r\nDownload started at : 9/5/2019 7:02:49 PM for D:\\IntelligentDataManagement\\Prod\\CosmosWorker_2019_9_4\\ScopeWorkingDir\\TheScript_e7d36522-f12c-4889-ba77-37ee592a0761_7BD75D30E767E37E\\IDEAsMSSalesOrgs.view\r\n.\r\nDownload Ended at : 9/5/2019 7:02:51 PM for D:\\IntelligentDataManagement\\Prod\\CosmosWorker_2019_9_4\\ScopeWorkingDir\\TheScript_e7d36522-f12c-4889-ba77-37ee592a0761_7BD75D30E767E37E\\IDEAsMSSalesOrgs.view\r\n9/5/2019 7:02:51 PM:  SyntaxVerifier => 0.0031 s\r\n9/5/2019 7:02:53 PM:  SyntaxVerifier => 0.0008 s\r\n9/5/2019 7:02:53 PM:  DdlResolver => 0.0010 s\r\n9/5/2019 7:02:53 PM:  ViewResolverPass => 0.0000 s\r\nDownload started at : 9/5/2019 7:02:54 PM for D:\\IntelligentDataManagement\\Prod\\CosmosWorker_2019_9_4\\ScopeWorkingDir\\TheScript_e7d36522-f12c-4889-ba77-37ee592a0761_7BD75D30E767E37E\\IDEAsCalc.view\r\n.\r\nDownload Ended at : 9/5/2019 7:02:56 PM for D:\\IntelligentDataManagement\\Prod\\CosmosWorker_2019_9_4\\ScopeWorkingDir\\TheScript_e7d36522-f12c-4889-ba77-37ee592a0761_7BD75D30E767E37E\\IDEAsCalc.view\r\n9/5/2019 7:02:56 PM:  SyntaxVerifier => 0.0001 s\r\n9/5/2019 7:02:58 PM:  SyntaxVerifier => 0.0029 s\r\n9/5/2019 7:02:58 PM:  DdlResolver => 0.0010 s\r\n9/5/2019 7:02:58 PM:  ViewResolverPass => 0.0000 s\r\n9/5/2019 7:02:58 PM:  ViewResolverPass => 0.0000 s\r\n9/5/2019 7:02:58 PM:  ViewResolverPass => 0.0000 s\r\n9/5/2019 7:02:58 PM:  AstBuilder => 26.1344 s\r\n9/5/2019 7:02:58 PM:  ViewResolverPass => 0.0069 s\r\n9/5/2019 7:02:58 PM:  AssemblyResolverPass => 0.0026 s\r\n9/5/2019 7:02:58 PM:  ResourceReferencePass => 0.0017 s\r\n9/5/2019 7:03:47 PM:  InputOutputPass => 49.5435 s\r\n9/5/2019 7:03:53 PM:  BinderPass => 5.5888 s\r\n9/5/2019 7:03:53 PM:  UserCode => 0.0011 s\r\n9/5/2019 7:03:53 PM:  SemanticAnalyzerPass => 0.0630 s\r\n9/5/2019 7:03:53 PM:  ErrorReporterPass => 0.0405 s\r\n9/5/2019 7:03:53 PM:  Finished FrontEndRun... => 1:21.4075 s\r\n9/5/2019 7:03:53 PM:  Starting OptimizerRun...\r\n9/5/2019 7:03:53 PM:  GenerateOptTreePass => 0.1985 s\r\n\r\n--==== CQO Optimization ====--\r\nTraceflag 402 is ON\r\nTraceflag 413 is ON\r\nTraceflag 901 is ON\r\nTraceflag 611 is ON\r\nTraceflag 905 is ON\r\nTraceflag 571 is ON\r\nTraceflag 568 is ON\r\nTraceflag 569 is ON\r\nTraceflag 203 is ON\r\nTraceflag 546 is ON\r\nTraceflag 562 is ON\r\nTraceflag 563 is ON\r\nTimer[CQO - Init] = 0.0178851 s\r\nTimer[CQO - CopyIn] = 0.100858 s\r\nTimer[CQO - Search - Init] = 0.0002263 s\r\nTimer[CQO - Search - NNF] = 0.001636 s\r\nTimer[CQO - Search - PreOptimization] = 0.0004396 s\r\nPruning partitions and streamsets\r\nSimplifying relational tree\r\nTimer[CQO - Search - Simplification] = 0.0093777 s\r\nTimer[CQO - Search - Join Reordering] = 9e-07 s\r\nTimer[CQO - Search - Expression Sharing] = 0.0162185 s\r\nTimer[CQO - Search - Optimization] = 0.231003 s\r\nTimer[CQO - Search - Subtotal] = 0.256888 s\r\nTimer[CQO - Showplan] = 0.0212782 s\r\nTimer[CQO - Stage Generation] = 0.533905 s\r\nTimer[CQO - PostOptimization] = 0.0049358 s\r\nTimer[CQO - Total] = 0.942652 s\r\n9/5/2019 7:03:54 PM:  CQO: Optimization succeeded. => 0.9880 s\r\n9/5/2019 7:03:54 PM:  Total input file count: 11\r\n9/5/2019 7:03:54 PM:  Total output file count: 1\r\n9/5/2019 7:03:54 PM:  Starting BackEndRun...\r\n9/5/2019 7:03:54 PM:  Algebra and managed code generation finished. => 0.3786 s\r\n9/5/2019 7:03:54 PM:  *** Exiting post-optimization => 1:23.3350 s\r\n9/5/2019 7:03:54 PM:  C# code emission finished. => 0.0310 s\r\n9/5/2019 7:03:55 PM:  C++ CodeGen finished. => 0.9586 s\r\n*** Entering compilation, time elapsed until this point: 00:01:24.3571783\r\nGenerated C# code size: 3186557 bytes\r\n*** Done with C# compilation, time elapsed until this point: 00:01:26.3963812\r\nGenerated C++ code size: 2499032 bytes\r\nIt'll be timeout in 3513519ms\r\nPeak physical memory usage of the process: -1, Peak paged memory usage of the process: -1, Peak virtual memory usage of the process: -1.\r\nManaged -- Serial -- compile:\r\nC++: time spent in compile 4.2968705 sec\r\nIt'll be timeout in 3509225ms\r\nPeak physical memory usage of the process: -1, Peak paged memory usage of the process: -1, Peak virtual memory usage of the process: -1.\r\nNative -- Serial -- compile:\r\nC++: time spent in compile 33.093713 sec\r\n*** Done with C++ compilation, time elapsed until this point: 00:02:03.8679546\r\nIt'll be timeout in 3476133ms\r\nPeak physical memory usage of the process: -1, Peak paged memory usage of the process: -1, Peak virtual memory usage of the process: -1.\r\nC++: time spent in linking 1.3593753 sec\r\n*** Done with C++ linking, time elapsed until this point: 00:02:05.2275063\r\n*** Exiting compilation, time elapsed until this point: 00:02:05.2281084\r\n9/5/2019 7:04:36 PM:  Generated Code Compilation finished. => 40.8965 s\r\n9/5/2019 7:04:36 PM:  Finished BackEndRun... => 42.2803 s\r\n9/5/2019 7:04:36 PM:  Finished compilation!\r\n9/5/2019 7:04:36 PM:  COMPILATIONTIME|JobId:|FriendlyName:|Mode:Default|Overall: 125.4s 11.9cpu|FrontEndRun: 81.4s 7.4cpu|RoslynTimers: 501x 15.7s 31.0ms/x 6.0cpu|OptimizerRun: 1.0s 1.9cpu|BackEndRun: 42.3s 1.6cpu|ExternalTimers: 49x 65.7s 340.0ms/x 2.7cpu\r\n9/5/2019 7:04:36 PM:  FrontEndTimers|FrontEndRun: 81.4s 7.4cpu|AssemblyResolverPass:|AstBuilder: 26.1s 5.5cpu|BinderPass: 5.6s 1.3cpu|DdlResolver: 5x 0.2s 30.0ms/x 0.3cpu|ErrorReporterPass:|InputOutputPass: 49.5s 0.4cpu|GenerateOptTreePass: 0.2s 0.2cpu|GeneratedFilesAsync: 15x 0.9s 58.0ms/x 2.2cpu wait 0.1s|Parser: 320x 0.4s 1.0ms/x 0.5cpu|Preprocessing: 5x 10.9s 186.0ms/x 1.0cpu|ReferenceLoading:|ResourceReferencePass:|ResourcesDownloading:|SemanticAnalyzerPass: 0.1s 0.1cpu|SyntaxVerifier: 9x 0.3s 37.0ms/x 0.5cpu|TraceFile: 170x|ViewResolverPass: 4x 15.4s 850.0ms/x\r\n9/5/2019 7:04:36 PM:  RoslynTimers|ExpressionBinding: 37x 1.2s 31.0ms/x 1.1cpu|RoslynBinding: 27x 1.2s 42.0ms/x 1.1cpu|RoslynEnvironmentAsync: 0.3s 0.5cpu|RoslynFirstCall: 0.6s 0.6cpu|ConstantFolding: 301x 0.5s 1.0ms/x 0.5cpu|RoslynParsing: 28x 0.1s 2.0ms/x 0.1cpu|RoslynPostSemantic: 4x 0.2s 49.0ms/x 0.2cpu|RoslynPreSemantic: 28x 0.6s 23.0ms/x 0.6cpu|RoslynSemantic: 4x 0.1s 29.0ms/x 0.1cpu|RoslynScripting: 51x 11.0s 216.0ms/x 1.1cpu|OneColumnBinding: 11x|QualifiedColumnBinding: 8x\r\n9/5/2019 7:04:36 PM:  OptimizerTimers|OptimizerRun: 1.0s 1.9cpu|OptimizerWait:|ComputeSignature:|CreateSplitersOrSpools:|PostProcessExecutionPlan:|CreateWhereSelectEnumerators: 0.1s 0.1cpu|ComputePayloadMetadata:|SStreamStageProcessing:|ValidateStages:|CompileToAlgebra: 0.1s 0.1cpu|EstimateMemorySize:|CalculateBubbles:\r\n9/5/2019 7:04:36 PM:  BackendTimers|BackEndRun: 42.3s 1.6cpu|AdornAllWithMemoryModel: 0.1s 0.1cpu|AlgebraAndManagedCodeGen: 0.4s 0.4cpu|AnnotateIntermediateResults:|CodeCompiling: 40.9s 0.1cpu|CodeGeneration: 1.0s 1.0cpu|CreateCppReadyStage:|ManagedCodeEmission: 0.1cpu|NativeCodeGeneration: 1.0s 1.0cpu\r\n9/5/2019 7:04:36 PM:  ExternalTimers|VcClient: 33x 31.2s 944.0ms/x 1.0cpu|SStreamMetadataAsync: 11x 33.9s 80.0ms/x 0.3cpu|PlaybackAsync: 2x 0.6s 307.0ms/x 1.3cpu|UserCode: 3x 3.0ms/x\r\n\r\n24 compiler warning(s):\r\n\r\n\r\nWarning 1/24:\r\nA warning occurred in the statement at line 502 near the '###' marker:\r\n**************\r\nenantsPath;\r\n\r\n    // Explicit type conversion to int? to avoid scope warning on join perf.\r\n    MsOrgs = \r\n        SELECT (int?) OrgId AS OrgId\r\n            ,  ### MIOID\r\n            , City\r\n            , State\r\n            , PostalCode\r\n            , CountryCode\r\n            , TPSubsidiaryId\r\n            , SubSegmentId\r\n \r\n**************\r\nProblem: \r\nThe identifier MIOID is all upper case.\r\nDescription: \r\nCompiler reserves any identifier that is all upper case as a keyword.\r\nSolution: \r\nChange the identifier to use at least one lower case letter.\r\n\r\nWarning 2/24:\r\nA warning occurred in the statement at line 516 near the '###' marker:\r\n**************\r\nId\r\n            , AccountManager\r\n            , ATUName\r\n            , SubsidiarySubDistrictId\r\n        FROM (VIEW @MsOrgsPath);\r\n\r\nCalcOrgs =   \r\n      SELECT  ### (int?) TPID AS TPID\r\n            ,AM AS AccountManager\r\n            ,AccountStatus\r\n            ,AccountType\r\n            ,ATS AS AccountTS\r\n            ,ATUGro\r\n**************\r\nProblem: \r\nThe identifier TPID is all upper case.\r\nDescription: \r\nCompiler reserves any identifier that is all upper case as a keyword.\r\nSolution: \r\nChange the identifier to use at least one lower case letter.\r\n\r\nWarning 3/24:\r\nA warning occurred in the statement at line 516 near the '###' marker:\r\n**************\r\n    , AccountManager\r\n            , ATUName\r\n            , SubsidiarySubDistrictId\r\n        FROM (VIEW @MsOrgsPath);\r\n\r\nCalcOrgs =   \r\n      SELECT (int?) TPID  ### AS TPID\r\n            ,AM AS AccountManager\r\n            ,AccountStatus\r\n            ,AccountType\r\n            ,ATS AS AccountTS\r\n            ,ATUGroupManager\r\n \r\n**************\r\nProblem: \r\nThe identifier TPID is all upper case.\r\nDescription: \r\nCompiler reserves any identifier that is all upper case as a keyword.\r\nSolution: \r\nChange the identifier to use at least one lower case letter.\r\n\r\nWarning 4/24:\r\nA warning occurred in the statement at line 520 near the '###' marker:\r\n**************\r\nath);\r\n\r\nCalcOrgs =   \r\n      SELECT (int?) TPID AS TPID\r\n            ,AM AS AccountManager\r\n            ,AccountStatus\r\n            ,AccountType\r\n            , ### ATS AS AccountTS\r\n            ,ATUGroupManager\r\n            ,ATUGroup AS ATUGroupName\r\n            ,ATUManager\r\n            ,ATUName\r\n            ,CRMID AS CRMA\r\n**************\r\nProblem: \r\nThe identifier ATS is all upper case.\r\nDescription: \r\nCompiler reserves any identifier that is all upper case as a keyword.\r\nSolution: \r\nChange the identifier to use at least one lower case letter.\r\n\r\nWarning 5/24:\r\nA warning occurred in the statement at line 525 near the '###' marker:\r\n**************\r\n            ,ATS AS AccountTS\r\n            ,ATUGroupManager\r\n            ,ATUGroup AS ATUGroupName\r\n            ,ATUManager\r\n            ,ATUName\r\n            , ### CRMID AS CRMAccountID\r\n            ,CRMAccountName AS CRMCompanyName\r\n            ,(string)null AS GlobalAccountOrgType\r\n            ,GPID\r\n            ,GPName\r\n\r\n**************\r\nProblem: \r\nThe identifier CRMID is all upper case.\r\nDescription: \r\nCompiler reserves any identifier that is all upper case as a keyword.\r\nSolution: \r\nChange the identifier to use at least one lower case letter.\r\n\r\nWarning 6/24:\r\nA warning occurred in the statement at line 528 near the '###' marker:\r\n**************\r\n   ,ATUName\r\n            ,CRMID AS CRMAccountID\r\n            ,CRMAccountName AS CRMCompanyName\r\n            ,(string)null AS GlobalAccountOrgType\r\n            , ### GPID\r\n            ,GPName\r\n            ,(bool?)null AS IsForbes\r\n            ,(string)null AS LicensingSpecialistLS\r\n            ,SalesTerritory\r\n            ,H\r\n**************\r\nProblem: \r\nThe identifier GPID is all upper case.\r\nDescription: \r\nCompiler reserves any identifier that is all upper case as a keyword.\r\nSolution: \r\nChange the identifier to use at least one lower case letter.\r\n\r\nWarning 7/24:\r\nA warning occurred in the statement at line 533 near the '###' marker:\r\n**************\r\n,GPID\r\n            ,GPName\r\n            ,(bool?)null AS IsForbes\r\n            ,(string)null AS LicensingSpecialistLS\r\n            ,SalesTerritory\r\n            , ### HQDS\r\n            ,(string)null AS GlobalBusinessManager\r\n            ,(AccountStatus.ToLower() == \"active\" AND HQDS == \"HQ\") ? true : false AS IsS400\r\n        \r\n**************\r\nProblem: \r\nThe identifier HQDS is all upper case.\r\nDescription: \r\nCompiler reserves any identifier that is all upper case as a keyword.\r\nSolution: \r\nChange the identifier to use at least one lower case letter.\r\n\r\nWarning 8/24:\r\nA warning occurred in the statement at line 535 near the '###' marker:\r\n**************\r\n       ,(string)null AS LicensingSpecialistLS\r\n            ,SalesTerritory\r\n            ,HQDS\r\n            ,(string)null AS GlobalBusinessManager\r\n            , ### (AccountStatus.ToLower() == \"active\" AND HQDS == \"HQ\") ? true : false AS IsS400\r\n            FROM (VIEW @CalcPath PARAMS (HistoryDate = @HistoryDate));\r\n\r\n    T\r\n**************\r\nProblem: \r\nThe identifier HQDS is all upper case.\r\nDescription: \r\nCompiler reserves any identifier that is all upper case as a keyword.\r\nSolution: \r\nChange the identifier to use at least one lower case letter.\r\n\r\nWarning 9/24:\r\nA warning occurred in the statement at line 550 near the '###' marker:\r\n**************\r\n    LEFT OUTER JOIN MsTenants\r\n            ON Tenants.OMSTenantId == MsTenants.OMSTenantId;\r\n\r\n    TenantOrgInfo = \r\n        SELECT TenantOrgs.*\r\n            ,  ### MsOrgs.MIOID AS MSSalesMIOID\r\n            , MsOrgs.City AS MSSalesCity\r\n            , MsOrgs.State AS MSSalesState\r\n            , MsOrgs.PostalCode AS MSSalesPo\r\n**************\r\nProblem: \r\nThe identifier MIOID is all upper case.\r\nDescription: \r\nCompiler reserves any identifier that is all upper case as a keyword.\r\nSolution: \r\nChange the identifier to use at least one lower case letter.\r\n\r\nWarning 10/24:\r\nA warning occurred in the statement at line 578 near the '###' marker:\r\n**************\r\n     , CalcOrgs.ATUName\r\n            , CalcOrgs.CRMAccountID\r\n            , CalcOrgs.CRMCompanyName\r\n            , CalcOrgs.GlobalAccountOrgType\r\n            ,  ### CalcOrgs.GPID\r\n            , CalcOrgs.GPName\r\n            , CalcOrgs.IsForbes\r\n            , CalcOrgs.LicensingSpecialistLS\r\n            , CalcOrgs.SalesTerrito\r\n**************\r\nProblem: \r\nThe identifier GPID is all upper case.\r\nDescription: \r\nCompiler reserves any identifier that is all upper case as a keyword.\r\nSolution: \r\nChange the identifier to use at least one lower case letter.\r\n\r\nWarning 11/24:\r\nA warning occurred in the statement at line 583 near the '###' marker:\r\n**************\r\n         , CalcOrgs.GPName\r\n            , CalcOrgs.IsForbes\r\n            , CalcOrgs.LicensingSpecialistLS\r\n            , CalcOrgs.SalesTerritory\r\n            ,  ### CalcOrgs.HQDS\r\n            , CalcOrgs.GlobalBusinessManager\r\n            , CalcOrgs.IsS400 ?? false AS IsS400\r\n        FROM TenantOrgInfo\r\n        LEFT OUTER JO\r\n**************\r\nProblem: \r\nThe identifier HQDS is all upper case.\r\nDescription: \r\nCompiler reserves any identifier that is all upper case as a keyword.\r\nSolution: \r\nChange the identifier to use at least one lower case letter.\r\n\r\nWarning 12/24:\r\nA warning occurred in the statement at line 588 near the '###' marker:\r\n**************\r\n CalcOrgs.GlobalBusinessManager\r\n            , CalcOrgs.IsS400 ?? false AS IsS400\r\n        FROM TenantOrgInfo\r\n        LEFT OUTER JOIN CalcOrgs\r\n            ON  ### TenantOrgInfo.MSSalesTopParentOrgId  == CalcOrgs.TPID;\r\n\r\n    TenantOrgInfoWithGeo = \r\n        SELECT TenantOrgInfo.*\r\n            , MSSalesGeoHierarchy.MSSales\r\n**************\r\nProblem: \r\nThe identifier TPID is all upper case.\r\nDescription: \r\nCompiler reserves any identifier that is all upper case as a keyword.\r\nSolution: \r\nChange the identifier to use at least one lower case letter.\r\n\r\nWarning 13/24:\r\nA warning occurred in the statement at line 964 near the '###' marker:\r\n**************\r\ne\r\n             ,ATUManager\r\n             ,ATUName\r\n             ,CRMAccountID\r\n             ,CRMCompanyName\r\n             ,GlobalAccountOrgType\r\n             , ### GPID\r\n             ,GPName\r\n             ,IsForbes\r\n             ,LicensingSpecialistLS\r\n             ,SalesTerritory\r\n             ,HQDS\r\n             ,GlobalB\r\n**************\r\nProblem: \r\nThe identifier GPID is all upper case.\r\nDescription: \r\nCompiler reserves any identifier that is all upper case as a keyword.\r\nSolution: \r\nChange the identifier to use at least one lower case letter.\r\n\r\nWarning 14/24:\r\nA warning occurred in the statement at line 969 near the '###' marker:\r\n**************\r\nountOrgType\r\n             ,GPID\r\n             ,GPName\r\n             ,IsForbes\r\n             ,LicensingSpecialistLS\r\n             ,SalesTerritory\r\n             , ### HQDS\r\n             ,GlobalBusinessManager\r\n             ,IsS400\r\n             ,MSSalesCountryName\r\n             ,MSSalesCurrencyCode\r\n             ,MSSalesSubsi\r\n**************\r\nProblem: \r\nThe identifier HQDS is all upper case.\r\nDescription: \r\nCompiler reserves any identifier that is all upper case as a keyword.\r\nSolution: \r\nChange the identifier to use at least one lower case letter.\r\n\r\nWarning 15/24:\r\nA warning occurred in the statement at line 141 near the '###' marker:\r\n**************\r\nProfileSSTemplate, @ProfileDate);\r\n\r\n// =========================\r\n// Script\r\n// =========================\r\n\r\n    Orgs = SELECT \r\n    OrgId,\r\n    OrgName,\r\n     ### MIOID,\r\n    City ,\r\n    State ,\r\n    PostalCode ,\r\n    CountryCode ,\r\n    CountryShortCode ,\r\n    TPSubsidiaryId,\r\n    SubSegmentId,\r\n    VerticalCategoryId,\r\n \r\n**************\r\nProblem: \r\nThe identifier MIOID is all upper case.\r\nDescription: \r\nCompiler reserves any identifier that is all upper case as a keyword.\r\nSolution: \r\nChange the identifier to use at least one lower case letter.\r\n\r\nWarning 16/24:\r\nA warning occurred in the statement at line 196 near the '###' marker:\r\n**************\r\n        RegionID,\r\n        RegionName,\r\n        SubRegionID,\r\n        SubRegionName,\r\n        SubsidiaryID,\r\n        SubsidiaryName,\r\n        Country,\r\n         ### ATUID,\r\n        ATUName,\r\n        ATUGroupID,\r\n        ATUGroup,\r\n        CRMID,\r\n        CRMAccountName,\r\n        TPID,\r\n        TPAccountName,\r\n        GPID,\r\n\r\n**************\r\nProblem: \r\nThe identifier ATUID is all upper case.\r\nDescription: \r\nCompiler reserves any identifier that is all upper case as a keyword.\r\nSolution: \r\nChange the identifier to use at least one lower case letter.\r\n\r\nWarning 17/24:\r\nA warning occurred in the statement at line 200 near the '###' marker:\r\n**************\r\negionName,\r\n        SubsidiaryID,\r\n        SubsidiaryName,\r\n        Country,\r\n        ATUID,\r\n        ATUName,\r\n        ATUGroupID,\r\n        ATUGroup,\r\n         ### CRMID,\r\n        CRMAccountName,\r\n        TPID,\r\n        TPAccountName,\r\n        GPID,\r\n        GPName,\r\n        MIOID,\r\n        DUNSNumber,\r\n        Segment,\r\n \r\n**************\r\nProblem: \r\nThe identifier CRMID is all upper case.\r\nDescription: \r\nCompiler reserves any identifier that is all upper case as a keyword.\r\nSolution: \r\nChange the identifier to use at least one lower case letter.\r\n\r\nWarning 18/24:\r\nA warning occurred in the statement at line 202 near the '###' marker:\r\n**************\r\n  SubsidiaryName,\r\n        Country,\r\n        ATUID,\r\n        ATUName,\r\n        ATUGroupID,\r\n        ATUGroup,\r\n        CRMID,\r\n        CRMAccountName,\r\n         ### TPID,\r\n        TPAccountName,\r\n        GPID,\r\n        GPName,\r\n        MIOID,\r\n        DUNSNumber,\r\n        Segment,\r\n        SubSegment,\r\n        Industry,\r\n  \r\n**************\r\nProblem: \r\nThe identifier TPID is all upper case.\r\nDescription: \r\nCompiler reserves any identifier that is all upper case as a keyword.\r\nSolution: \r\nChange the identifier to use at least one lower case letter.\r\n\r\nWarning 19/24:\r\nA warning occurred in the statement at line 204 near the '###' marker:\r\n**************\r\n      ATUID,\r\n        ATUName,\r\n        ATUGroupID,\r\n        ATUGroup,\r\n        CRMID,\r\n        CRMAccountName,\r\n        TPID,\r\n        TPAccountName,\r\n         ### GPID,\r\n        GPName,\r\n        MIOID,\r\n        DUNSNumber,\r\n        Segment,\r\n        SubSegment,\r\n        Industry,\r\n        Vertical,\r\n        VerticalCatego\r\n**************\r\nProblem: \r\nThe identifier GPID is all upper case.\r\nDescription: \r\nCompiler reserves any identifier that is all upper case as a keyword.\r\nSolution: \r\nChange the identifier to use at least one lower case letter.\r\n\r\nWarning 20/24:\r\nA warning occurred in the statement at line 206 near the '###' marker:\r\n**************\r\n        ATUGroupID,\r\n        ATUGroup,\r\n        CRMID,\r\n        CRMAccountName,\r\n        TPID,\r\n        TPAccountName,\r\n        GPID,\r\n        GPName,\r\n         ### MIOID,\r\n        DUNSNumber,\r\n        Segment,\r\n        SubSegment,\r\n        Industry,\r\n        Vertical,\r\n        VerticalCategory,\r\n        AM,\r\n        ATUMan\r\n**************\r\nProblem: \r\nThe identifier MIOID is all upper case.\r\nDescription: \r\nCompiler reserves any identifier that is all upper case as a keyword.\r\nSolution: \r\nChange the identifier to use at least one lower case letter.\r\n\r\nWarning 21/24:\r\nA warning occurred in the statement at line 216 near the '###' marker:\r\n**************\r\nent,\r\n        SubSegment,\r\n        Industry,\r\n        Vertical,\r\n        VerticalCategory,\r\n        AM,\r\n        ATUManager,\r\n        ATUGroupManager,\r\n         ### ATS,\r\n        Director,\r\n        PCCount,\r\n        x86Servers,\r\n        LOBDevices,\r\n        MobileDevices,\r\n        TaxID,\r\n        LastModifiedDate,\r\n        \r\n**************\r\nProblem: \r\nThe identifier ATS is all upper case.\r\nDescription: \r\nCompiler reserves any identifier that is all upper case as a keyword.\r\nSolution: \r\nChange the identifier to use at least one lower case letter.\r\n\r\nWarning 22/24:\r\nA warning occurred in the statement at line 229 near the '###' marker:\r\n**************\r\n  LastModifiedDate,\r\n        LastModifiedAlias,\r\n        SalesTerritory,\r\n        SalesTerritoryID,\r\n        ITGovernance,\r\n        TPIDEmployeeCount,\r\n         ### HQDS,\r\n        GovernmentLevel,\r\n        SalesUnitID,\r\n        SalesUnit,\r\n        SalesGroupID,\r\n        SalesGroup,\r\n        SegmentGroup,\r\n        SMBMALReas\r\n**************\r\nProblem: \r\nThe identifier HQDS is all upper case.\r\nDescription: \r\nCompiler reserves any identifier that is all upper case as a keyword.\r\nSolution: \r\nChange the identifier to use at least one lower case letter.\r\n\r\nWarning 23/24:\r\nA warning occurred in the statement at line 240 near the '###' marker:\r\n**************\r\n  SalesGroupID,\r\n        SalesGroup,\r\n        SegmentGroup,\r\n        SMBMALReason,\r\n        ESMALAccountPriority,\r\n        IsESManaged,\r\n        HiPo,\r\n         ### (AccountStatus.ToLower() == \"active\" AND HQDS == \"HQ\") ? true : false AS IsS400\r\n              FROM (SSTREAM @CalcPath);\r\n\r\nEND;\r\n**************\r\nProblem: \r\nThe identifier HQDS is all upper case.\r\nDescription: \r\nCompiler reserves any identifier that is all upper case as a keyword.\r\nSolution: \r\nChange the identifier to use at least one lower case letter.\r\n\r\nWarning 24/24:\r\nA warning occurred in the statement at line 895 near the '###' marker:\r\n**************\r\n\r\n// De-dup the data. This removes the one duplicate we have from joining the MSSales/Calc data in the view.\r\n    Deduped = \r\n        SELECT *,\r\n                ### ROW_NUMBER() OVER(PARTITION BY OMSTenantId) AS Rank\r\n        FROM TenantDataWithSubscriptions\r\n        HAVING Rank == 1;\r\n\r\n    FinalTenantData = \r\n       SELEC\r\n**************\r\nProblem: \r\nThe operation 'ROW_NUMBER' is potentially non-deterministic.\r\nDescription: \r\nThe operation is potentially non-deterministic.\r\nSolution: \r\nUsing non-deterministic operations is not a recommended practice.\r\n\r\nCompilation succeeded.\r\n\r\n\r\n";
            var wrapperIndeces = a.LastIndexOf("**************", StringComparison.InvariantCultureIgnoreCase);

            Console.WriteLine(a.Substring(0, wrapperIndeces));

            if (Debugger.IsAttached)
            {
                Console.WriteLine("press enter key to exit...");
                Console.ReadLine();
            }
        }

    }
}
